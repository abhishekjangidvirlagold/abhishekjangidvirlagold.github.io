<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Virla Gold TMX 550D Poster Tool</title>

<style>
body{
  margin:0;
  font-family: Arial, sans-serif;
  background:#f4f6f8;
}

/* ---------- LOGIN PAGE ---------- */
#loginPage{
  height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
}
.login-box{
  background:#fff;
  padding:30px;
  width:320px;
  border-radius:10px;
  box-shadow:0 10px 30px rgba(0,0,0,0.15);
}
.login-box h2{
  text-align:center;
  margin-bottom:20px;
}
.login-box input{
  width:100%;
  padding:10px;
  margin-bottom:15px;
  font-size:16px;
}
.login-box button{
  width:100%;
  padding:10px;
  background:#007bff;
  color:#fff;
  border:none;
  font-size:16px;
  cursor:pointer;
  border-radius:5px;
}
.login-box p{
  color:red;
  text-align:center;
  display:none;
}

/* ---------- APP PAGE ---------- */
#appPage{
  display:none;
  padding:20px;
}
#controls{
  background:#fff;
  padding:20px;
  border-radius:10px;
  max-width:500px;
  margin:auto;
  box-shadow:0 5px 20px rgba(0,0,0,0.1);
}
label{font-weight:bold;}
input,button{
  width:100%;
  padding:10px;
  margin-top:10px;
  font-size:16px;
}
button{
  background:#28a745;
  color:white;
  border:none;
  border-radius:5px;
  cursor:pointer;
}
canvas{
  margin-top:20px;
  max-width:100%;
  border:1px solid #ddd;
}
#downloadLink{
  display:none;
  text-align:center;
  margin-top:20px;
  background:#007bff;
  color:#fff;
  padding:10px;
  border-radius:5px;
  text-decoration:none;
}
</style>
</head>

<body>

<!-- LOGIN PAGE -->
<div id="loginPage">
  <div class="login-box">
    <h2>Secure Login</h2>
    <input type="password" id="passwordInput" placeholder="Enter Password">
    <button onclick="checkPassword()">Login</button>
    <p id="loginError">Invalid Password</p>
  </div>
</div>

<!-- APP PAGE -->
<div id="appPage">
  <h2 style="text-align:center">Virla Gold TMX 550D Poster Generator</h2>

  <div id="controls">
    <label>Date</label>
    <input type="date" id="currentDate">

    <label>Base Price</label>
    <input type="text" id="baseRate" value="53500">

    <button onclick="generatePoster()">Generate Poster</button>
  </div>

  <div style="text-align:center">
    <canvas id="posterCanvas"></canvas>
    <a id="downloadLink" download>Download Poster</a>
  </div>
</div>

<script>
/* ---------- PASSWORD (SHA-256 HASH) ---------- */
const PASSWORD_HASH = "490cfee36bc2aaf4af9020e63d9eb75c38a8e4fa68ea309a7be94e1420315e5b";


async function sha256(text){
  const buf = await crypto.subtle.digest("SHA-256", new TextEncoder().encode(text));
  return Array.from(new Uint8Array(buf)).map(b=>b.toString(16).padStart(2,"0")).join("");
}

async function checkPassword(){
  const input = document.getElementById("passwordInput").value;
  const hash = await sha256(input);
  if(hash === PASSWORD_HASH){
    document.getElementById("loginPage").style.display="none";
    document.getElementById("appPage").style.display="block";
    initPoster();
  }else{
    document.getElementById("loginError").style.display="block";
  }
}

/* ---------- POSTER LOGIC ---------- */
const canvas = document.getElementById("posterCanvas");
const ctx = canvas.getContext("2d");
let bgImage = new Image();
let pixelsPerInch = 0;

const CORELDRAW_WIDTH_INCHES = 8.5;

function initPoster(){
  const today = new Date().toISOString().split("T")[0];
  document.getElementById("currentDate").value = today;

  bgImage.src = "Virla_Blank_Poster.jpg";
  bgImage.onload = ()=>{
    canvas.width = bgImage.width;
    canvas.height = bgImage.height;
    pixelsPerInch = bgImage.width / CORELDRAW_WIDTH_INCHES;
    drawPoster();
  };
}

function drawPoster(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  ctx.drawImage(bgImage,0,0);

  const date = document.getElementById("currentDate").value;
  const rate = document.getElementById("baseRate").value;

  ctx.fillStyle="#ffffff";
  ctx.font=`${18*(pixelsPerInch/72)}px Arial`;
  ctx.textAlign="center";
  ctx.fillText(formatDate(date), pixelsPerInch*1.216, canvas.height - pixelsPerInch*7.85);

  ctx.fillStyle="#20374D";
  ctx.font=`bold ${20*(pixelsPerInch/72)}px Arial`;
  ctx.fillText(`â‚¹ ${rate}/-`, pixelsPerInch*6.131, canvas.height - pixelsPerInch*5.14);

  const link=document.getElementById("downloadLink");
  link.href=canvas.toDataURL("image/jpeg",0.9);
  link.style.display="inline-block";
}

function generatePoster(){ drawPoster(); }

function formatDate(d){
  const [y,m,dd]=d.split("-");
  return `Date - ${dd}/${m}/${y}`;
}
</script>

</body>
</html>

